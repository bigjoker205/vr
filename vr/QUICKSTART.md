# VR Video Player - 快速开始指南

## 项目概述

这是一个功能完整的Android VR视频播放器应用。支持从URL加载视频、VR分屏显示、陀螺仪控制和丰富的播放参数调整。

## 快速开始

### 编译和运行

1. **编译项目**
```bash
cd vr
./gradlew build
```

2. **安装到设备**
```bash
./gradlew installDebug
```

3. **在设备上运行** - 点击应用图标启动应用

### 基本使用

1. **启动应用** - 应用启动后显示主界面
2. **输入视频链接** - 在输入框中粘贴视频URL
3. **选择播放模式**：
   - 点击"VR模式" - 分屏显示，用VR眼镜观看
   - 点击"普通模式" - 标准视频播放

### VR模式操作

1. **查看视频** - 将手机放入Google Cardboard或类似VR设备
2. **控制视角** - 移动手机，利用陀螺仪改变视角
3. **调整参数**：
   - 速度 - 调整播放速度
   - 瞳距 - 调整眼镜光学中心距
   - 屏幕 - 调整虚拟屏幕大小

## 项目结构说明

### Java代码

```
app/src/main/java/com/vrvideo/player/
├── MainActivity.java                    # 主界面 - URL输入和模式选择
├── ui/
│   └── VRPlayerActivity.java           # 播放器界面 - 视频播放和控制
├── vr/
│   ├── VRRenderView.java               # VR视图 - OpenGL渲染容器
│   └── VRRenderer.java                 # VR渲染器 - 球形纹理映射
└── utils/
    ├── VideoUrlUtils.java              # URL工具类
    ├── VRSettings.java                 # VR配置工具类
    └── TimeFormatter.java              # 时间格式化工具类
```

### 资源文件

```
app/src/main/res/
├── layout/
│   ├── activity_main.xml               # 主界面布局
│   └── activity_vr_player.xml          # 播放器界面布局
└── values/
    ├── strings.xml                     # 字符串资源
    ├── colors.xml                      # 颜色资源
    ├── dimens.xml                      # 尺寸资源
    └── themes.xml                      # 主题资源
```

## 支持的视频格式

- MP4 (H.264/H.265)
- HLS (m3u8)
- DASH (mpd)
- Matroska (mkv)
- WebM

## 系统要求

- Android 7.0 (API 24) 或更高
- 至少1GB RAM（推荐2GB+）
- 陀螺仪传感器（VR模式）
- OpenGL ES 2.0 支持

## 硬件兼容性

### 推荐设备
- 高端手机 (2GB+ RAM)
- 陀螺仪精度高的设备
- 屏幕分辨率 1080p 或以上

### VR设备支持
- Google Cardboard
- Samsung Gear VR
- 其他通用VR眼镜

## 权限说明

应用需要以下权限：
- `INTERNET` - 下载视频
- `ACCESS_NETWORK_STATE` - 检查网络
- `CAMERA` - VR设备交互（可选）
- `ACCESS_FINE_LOCATION` - 传感器校准（可选）

## 主要功能详解

### 1. URL视频输入
- 支持HTTP/HTTPS协议的视频链接
- 自动格式识别和类型判断
- 实时URL验证反馈

### 2. VR渲染
- 双眼分屏显示
- 左右眼分别渲染不同视角
- 可配置的瞳距和屏幕参数

### 3. 陀螺仪控制
- 实时陀螺仪数据处理
- 平滑的旋转矩阵应用
- 可启用/禁用的控制选项

### 4. 播放控制
- 暂停/播放
- 播放速度 (0.5x - 2.0x)
- 快进/快退
- 进度条精确拖拽

### 5. 参数调整
- 瞳距 (5cm - 8cm)
- 屏幕大小 (3" - 7")
- 陀螺仪灵敏度
- 视场角调整

## 开发要点

### VR渲染管线
1. 加载视频帧到纹理
2. 创建立体投影矩阵
3. 为左眼渲染视图
4. 为右眼渲染视图
5. 应用陀螺仪旋转变换

### 外部库
- **ExoPlayer** - 视频播放引擎
- **Google VR SDK** - VR功能支持
- **OpenGL ES 2.0** - 3D图形渲染

## 常见问题解答

### Q: VR模式没有显示陀螺仪控制的视角变化？
A: 
1. 检查设备是否有陀螺仪传感器
2. 确认应用有权限访问传感器
3. 尝试在手机设置中校准陀螺仪
4. 确保手机不在平坦表面上（避免重力干扰）

### Q: 视频播放卡顿或延迟？
A:
1. 检查网络连接速度
2. 尝试降低播放速度或分辨率
3. 清除应用缓存数据
4. 关闭其他后台应用

### Q: 如何支持本地视频文件？
A: 需要修改代码以支持content:// URI，可参考ExoPlayer文档

### Q: 如何添加字幕支持？
A: 使用ExoPlayer的SubtitleConfiguration功能

## 后续改进建议

### 短期
- [ ] 实现更多播放菜单
- [ ] 添加手势控制
- [ ] 视频加载进度显示
- [ ] 历史播放记录

### 中期
- [ ] 视频缓存机制
- [ ] 字幕支持
- [ ] 音量和亮度调节
- [ ] 截图功能

### 长期
- [ ] 云同步播放进度
- [ ] VR控制器支持
- [ ] 空间音频渲染
- [ ] 多人在线观看

## 性能优化

### 内存优化
- 使用合适的纹理分辨率
- 及时释放不需要的资源
- 避免频繁的内存分配

### 渲染优化
- 帧率限制
- 减少不必要的绘制调用
- 使用VBO和VAO

### 网络优化
- 自适应比特率
- 智能预加载
- 缓冲管理

## 测试清单

- [ ] URL输入验证测试
- [ ] VR模式渲染测试
- [ ] 陀螺仪响应测试
- [ ] 播放控制功能测试
- [ ] 参数调整测试
- [ ] 不同网络环境测试
- [ ] 不同设备兼容性测试
- [ ] 电池消耗测试

## 许可证

MIT License - 自由使用和修改

## 反馈和支持

如有问题或建议，欢迎提交issue或pull request。

---

**更新时间**: 2026年2月3日
**版本**: 1.0.0
